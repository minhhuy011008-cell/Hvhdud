local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Config
local config = {
    purchaseRange = 20,
    autoEnabled = false,
    scanInterval = 0.1,
    selectedItems = {}
}

-- Báº¡n Ä‘iá»n items vÃ o Ä‘Ã¢y
local allItems = {
    -- Items cá»§a báº¡n
}

local boughtPrompts = {}
local gui = nil
local mainFrame = nil
local menuVisible = true

-- Create GUI (Landscape Style)
local function createGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "AutoBuyMenu"
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    -- Toggle Button
    local toggleMenuBtn = Instance.new("TextButton")
    toggleMenuBtn.Name = "ToggleMenuBtn"
    toggleMenuBtn.Size = UDim2.new(0, 45, 0, 45)
    toggleMenuBtn.Position = UDim2.new(0, 10, 0.5, -22)
    toggleMenuBtn.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    toggleMenuBtn.Text = "â˜°"
    toggleMenuBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleMenuBtn.TextSize = 20
    toggleMenuBtn.Font = Enum.Font.GothamBold
    toggleMenuBtn.BorderSizePixel = 0
    toggleMenuBtn.Parent = screenGui
    
    local toggleMenuCorner = Instance.new("UICorner")
    toggleMenuCorner.CornerRadius = UDim.new(0, 8)
    toggleMenuCorner.Parent = toggleMenuBtn
    
    -- Main Frame (Landscape - 580x380)
    local frame = Instance.new("Frame")
    frame.Name = "MainFrame"
    frame.Size = UDim2.new(0, 580, 0, 380)
    frame.Position = UDim2.new(0.5, -290, 0.5, -190)
    frame.BackgroundColor3 = Color3.fromRGB(18, 18, 24)
    frame.BorderSizePixel = 0
    frame.Active = true
    frame.Draggable = true
    frame.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = frame
    
    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.Size = UDim2.new(1, 30, 1, 30)
    shadow.Position = UDim2.new(0, -15, 0, -15)
    shadow.BackgroundTransparency = 1
    shadow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
    shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    shadow.ImageTransparency = 0.7
    shadow.ScaleType = Enum.ScaleType.Slice
    shadow.SliceCenter = Rect.new(10, 10, 118, 118)
    shadow.ZIndex = 0
    shadow.Parent = frame
    
    -- Header
    local header = Instance.new("Frame")
    header.Name = "Header"
    header.Size = UDim2.new(1, 0, 0, 50)
    header.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    header.BorderSizePixel = 0
    header.Parent = frame
    
    local headerCorner = Instance.new("UICorner")
    headerCorner.CornerRadius = UDim.new(0, 12)
    headerCorner.Parent = header
    
    local headerBottom = Instance.new("Frame")
    headerBottom.Size = UDim2.new(1, 0, 0, 12)
    headerBottom.Position = UDim2.new(0, 0, 1, -12)
    headerBottom.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    headerBottom.BorderSizePixel = 0
    headerBottom.Parent = header
    
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(0, 200, 1, 0)
    title.Position = UDim2.new(0, 18, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "Pulsar X | Steal A Brainrot"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 15
    title.Font = Enum.Font.GothamBold
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = header
    
    local subtitle = Instance.new("TextLabel")
    subtitle.Size = UDim2.new(0, 200, 0, 15)
    subtitle.Position = UDim2.new(0, 18, 0, 28)
    subtitle.BackgroundTransparency = 1
    subtitle.Text = "Purchase Brainrot Section"
    subtitle.TextColor3 = Color3.fromRGB(150, 150, 160)
    subtitle.TextSize = 11
    subtitle.Font = Enum.Font.Gotham
    subtitle.TextXAlignment = Enum.TextXAlignment.Left
    subtitle.Parent = header
    
    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 35, 0, 35)
    closeBtn.Position = UDim2.new(1, -45, 0, 7)
    closeBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
    closeBtn.Text = "X"
    closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeBtn.TextSize = 16
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.BorderSizePixel = 0
    closeBtn.Parent = header
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 8)
    closeCorner.Parent = closeBtn
    
    closeBtn.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)
    
    -- Content Area
    local content = Instance.new("Frame")
    content.Name = "Content"
    content.Size = UDim2.new(1, -32, 1, -80)
    content.Position = UDim2.new(0, 16, 0, 60)
    content.BackgroundTransparency = 1
    content.Parent = frame
    
    -- Select Brainrots Section
    local selectSection = Instance.new("Frame")
    selectSection.Size = UDim2.new(1, 0, 0, 60)
    selectSection.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    selectSection.BorderSizePixel = 0
    selectSection.Parent = content
    
    local selectCorner = Instance.new("UICorner")
    selectCorner.CornerRadius = UDim.new(0, 10)
    selectCorner.Parent = selectSection
    
    local selectTitle = Instance.new("TextLabel")
    selectTitle.Size = UDim2.new(1, -20, 0, 18)
    selectTitle.Position = UDim2.new(0, 12, 0, 6)
    selectTitle.BackgroundTransparency = 1
    selectTitle.Text = "Select Brainrots"
    selectTitle.TextColor3 = Color3.fromRGB(180, 180, 190)
    selectTitle.TextSize = 11
    selectTitle.Font = Enum.Font.Gotham
    selectTitle.TextXAlignment = Enum.TextXAlignment.Left
    selectTitle.Parent = selectSection
    
    local selectedDisplay = Instance.new("TextLabel")
    selectedDisplay.Name = "SelectedDisplay"
    selectedDisplay.Size = UDim2.new(1, -24, 0, 20)
    selectedDisplay.Position = UDim2.new(0, 12, 0, 24)
    selectedDisplay.BackgroundTransparency = 1
    selectedDisplay.Text = "No items selected"
    selectedDisplay.TextColor3 = Color3.fromRGB(120, 120, 130)
    selectedDisplay.TextSize = 11
    selectedDisplay.Font = Enum.Font.Gotham
    selectedDisplay.TextXAlignment = Enum.TextXAlignment.Left
    selectedDisplay.TextYAlignment = Enum.TextYAlignment.Top
    selectedDisplay.TextWrapped = true
    selectedDisplay.Parent = selectSection
    
    local editBtn = Instance.new("TextButton")
    editBtn.Name = "EditBtn"
    editBtn.Size = UDim2.new(0, 60, 0, 26)
    editBtn.Position = UDim2.new(1, -72, 1, -30)
    editBtn.BackgroundColor3 = Color3.fromRGB(45, 110, 200)
    editBtn.Text = "Edit"
    editBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    editBtn.TextSize = 12
    editBtn.Font = Enum.Font.GothamBold
    editBtn.BorderSizePixel = 0
    editBtn.Parent = selectSection
    
    local editCorner = Instance.new("UICorner")
    editCorner.CornerRadius = UDim.new(0, 7)
    editCorner.Parent = editBtn
    
    -- Auto Purchase Toggle
    local autoSection = Instance.new("Frame")
    autoSection.Size = UDim2.new(1, 0, 0, 45)
    autoSection.Position = UDim2.new(0, 0, 0, 68)
    autoSection.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    autoSection.BorderSizePixel = 0
    autoSection.Parent = content
    
    local autoCorner = Instance.new("UICorner")
    autoCorner.CornerRadius = UDim.new(0, 10)
    autoCorner.Parent = autoSection
    
    local autoLabel = Instance.new("TextLabel")
    autoLabel.Size = UDim2.new(0, 200, 1, 0)
    autoLabel.Position = UDim2.new(0, 12, 0, 0)
    autoLabel.BackgroundTransparency = 1
    autoLabel.Text = "Auto Purchase Brainrots"
    autoLabel.TextColor3 = Color3.fromRGB(200, 200, 210)
    autoLabel.TextSize = 13
    autoLabel.Font = Enum.Font.GothamBold
    autoLabel.TextXAlignment = Enum.TextXAlignment.Left
    autoLabel.Parent = autoSection
    
    local autoToggle = Instance.new("TextButton")
    autoToggle.Name = "AutoToggle"
    autoToggle.Size = UDim2.new(0, 50, 0, 24)
    autoToggle.Position = UDim2.new(1, -62, 0.5, -12)
    autoToggle.BackgroundColor3 = Color3.fromRGB(60, 60, 75)
    autoToggle.Text = ""
    autoToggle.BorderSizePixel = 0
    autoToggle.Parent = autoSection
    
    local toggleCorner = Instance.new("UICorner")
    toggleCorner.CornerRadius = UDim.new(1, 0)
    toggleCorner.Parent = autoToggle
    
    local toggleCircle = Instance.new("Frame")
    toggleCircle.Name = "Circle"
    toggleCircle.Size = UDim2.new(0, 18, 0, 18)
    toggleCircle.Position = UDim2.new(0, 3, 0.5, -9)
    toggleCircle.BackgroundColor3 = Color3.fromRGB(200, 200, 210)
    toggleCircle.BorderSizePixel = 0
    toggleCircle.Parent = autoToggle
    
    local circleCorner = Instance.new("UICorner")
    circleCorner.CornerRadius = UDim.new(1, 0)
    circleCorner.Parent = toggleCircle
    
    -- Search Frame
    local searchFrame = Instance.new("Frame")
    searchFrame.Name = "SearchFrame"
    searchFrame.Size = UDim2.new(1, 0, 0, 38)
    searchFrame.Position = UDim2.new(0, 0, 0, 121)
    searchFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    searchFrame.BorderSizePixel = 0
    searchFrame.Visible = false
    searchFrame.Parent = content
    
    local searchCorner = Instance.new("UICorner")
    searchCorner.CornerRadius = UDim.new(0, 10)
    searchCorner.Parent = searchFrame
    
    local searchBox = Instance.new("TextBox")
    searchBox.Name = "SearchBox"
    searchBox.Size = UDim2.new(1, -24, 1, 0)
    searchBox.Position = UDim2.new(0, 12, 0, 0)
    searchBox.BackgroundTransparency = 1
    searchBox.PlaceholderText = "ğŸ” Search brainrot..."
    searchBox.PlaceholderColor3 = Color3.fromRGB(120, 120, 140)
    searchBox.Text = ""
    searchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    searchBox.TextSize = 12
    searchBox.Font = Enum.Font.Gotham
    searchBox.TextXAlignment = Enum.TextXAlignment.Left
    searchBox.ClearTextOnFocus = false
    searchBox.Parent = searchFrame
    
    -- Scroll Frame
    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Name = "ScrollFrame"
    scrollFrame.Size = UDim2.new(1, 0, 1, -167)
    scrollFrame.Position = UDim2.new(0, 0, 0, 167)
    scrollFrame.BackgroundColor3 = Color3.fromRGB(22, 22, 30)
    scrollFrame.BorderSizePixel = 0
    scrollFrame.ScrollBarThickness = 4
    scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(60, 60, 80)
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    scrollFrame.Visible = false
    scrollFrame.Parent = content
    
    local scrollCorner = Instance.new("UICorner")
    scrollCorner.CornerRadius = UDim.new(0, 10)
    scrollCorner.Parent = scrollFrame
    
    local listLayout = Instance.new("UIListLayout")
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.Padding = UDim.new(0, 4)
    listLayout.Parent = scrollFrame
    
    local padding = Instance.new("UIPadding")
    padding.PaddingTop = UDim.new(0, 8)
    padding.PaddingBottom = UDim.new(0, 8)
    padding.PaddingLeft = UDim.new(0, 8)
    padding.PaddingRight = UDim.new(0, 8)
    padding.Parent = scrollFrame
    
    -- Status Bar
    local statusBar = Instance.new("Frame")
    statusBar.Name = "StatusBar"
    statusBar.Size = UDim2.new(1, 0, 0, 38)
    statusBar.Position = UDim2.new(0, 0, 1, -46)
    statusBar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    statusBar.BorderSizePixel = 0
    statusBar.Parent = content
    
    local statusCorner = Instance.new("UICorner")
    statusCorner.CornerRadius = UDim.new(0, 10)
    statusCorner.Parent = statusBar
    
    local statusLabel = Instance.new("TextLabel")
    statusLabel.Name = "StatusLabel"
    statusLabel.Size = UDim2.new(1, -24, 1, 0)
    statusLabel.Position = UDim2.new(0, 12, 0, 0)
    statusLabel.BackgroundTransparency = 1
    statusLabel.Text = "Status: Idle"
    statusLabel.TextColor3 = Color3.fromRGB(180, 180, 200)
    statusLabel.TextSize = 12
    statusLabel.Font = Enum.Font.Gotham
    statusLabel.TextXAlignment = Enum.TextXAlignment.Left
    statusLabel.Parent = statusBar
    
    screenGui.Parent = player:WaitForChild("PlayerGui")
    return screenGui, frame, autoToggle, toggleCircle, searchBox, scrollFrame, statusLabel, selectedDisplay, searchFrame, editBtn, toggleMenuBtn
end

local function createItemButton(itemName, parent, index)
    local btn = Instance.new("TextButton")
    btn.Name = itemName
    btn.Size = UDim2.new(1, -16, 0, 32)
    btn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    btn.Text = ""
    btn.BorderSizePixel = 0
    btn.LayoutOrder = index
    btn.AutoButtonColor = false
    btn.Parent = parent
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = btn
    
    local checkbox = Instance.new("Frame")
    checkbox.Name = "Checkbox"
    checkbox.Size = UDim2.new(0, 20, 0, 20)
    checkbox.Position = UDim2.new(0, 8, 0.5, -10)
    checkbox.BackgroundColor3 = Color3.fromRGB(40, 40, 55)
    checkbox.BorderSizePixel = 0
    checkbox.Parent = btn
    
    local checkCorner = Instance.new("UICorner")
    checkCorner.CornerRadius = UDim.new(0, 4)
    checkCorner.Parent = checkbox
    
    local checkmark = Instance.new("TextLabel")
    checkmark.Name = "Checkmark"
    checkmark.Size = UDim2.new(1, 0, 1, 0)
    checkmark.BackgroundTransparency = 1
    checkmark.Text = "âœ“"
    checkmark.TextColor3 = Color3.fromRGB(100, 255, 120)
    checkmark.TextSize = 15
    checkmark.Font = Enum.Font.GothamBold
    checkmark.Visible = false
    checkmark.Parent = checkbox
    
    local label = Instance.new("TextLabel")
    label.Name = "Label"
    label.Size = UDim2.new(1, -40, 1, 0)
    label.Position = UDim2.new(0, 35, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = itemName
    label.TextColor3 = Color3.fromRGB(210, 210, 220)
    label.TextSize = 12
    label.Font = Enum.Font.Gotham
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.TextTruncate = Enum.TextTruncate.AtEnd
    label.Parent = btn
    
    return btn, checkmark
end

local function updateSelectedDisplay(display)
    local selected = {}
    for item in pairs(config.selectedItems) do
        local shortName = item:match("^(.-)%s%$") or item:sub(1, 18)
        table.insert(selected, shortName)
    end
    
    if #selected == 0 then
        display.Text = "No items selected"
        display.TextColor3 = Color3.fromRGB(120, 120, 130)
    else
        display.Text = table.concat(selected, ", ")
        display.TextColor3 = Color3.fromRGB(100, 180, 255)
    end
end

local function populateItems(scrollFrame, searchText, display)
    for _, child in ipairs(scrollFrame:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    local filteredItems = {}
    searchText = searchText:lower()
    
    for _, item in ipairs(allItems) do
        if searchText == "" or item:lower():find(searchText, 1, true) then
            table.insert(filteredItems, item)
        end
    end
    
    for i, item in ipairs(filteredItems) do
        local btn, checkmark = createItemButton(item, scrollFrame, i)
        
        if config.selectedItems[item] then
            checkmark.Visible = true
            btn.BackgroundColor3 = Color3.fromRGB(45, 65, 90)
        end
        
        btn.MouseButton1Click:Connect(function()
            config.selectedItems[item] = not config.selectedItems[item]
            checkmark.Visible = config.selectedItems[item]
            btn.BackgroundColor3 = config.selectedItems[item] and Color3.fromRGB(45, 65, 90) or Color3.fromRGB(30, 30, 40)
            updateSelectedDisplay(display)
        end)
        
        btn.MouseEnter:Connect(function()
            if not config.selectedItems[item] then
                btn.BackgroundColor3 = Color3.fromRGB(38, 38, 50)
            end
        end)
        
        btn.MouseLeave:Connect(function()
            if not config.selectedItems[item] then
                btn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
            end
        end)
    end
    
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, #filteredItems * 36 + 16)
end

local function matchesTarget(text)
    if not text then return false end
    text = text:lower()
    
    -- Kiá»ƒm tra cÃ³ item nÃ o Ä‘Æ°á»£c chá»n khÃ´ng
    local hasSelection = false
    for _ in pairs(config.selectedItems) do
        hasSelection = true
        break
    end
    
    -- Náº¿u khÃ´ng cÃ³ item nÃ o Ä‘Æ°á»£c chá»n, return false
    if not hasSelection then return false end
    
    -- Kiá»ƒm tra text cÃ³ khá»›p vá»›i item Ä‘Ã£ chá»n
    for item in pairs(config.selectedItems) do
        if text:find(item:lower(), 1, true) then
            return true
        end
    end
    return false
end

local function getPromptPosition(prompt)
    if prompt.Parent then
        if prompt.Parent:IsA("BasePart") then
            return prompt.Parent.Position
        elseif prompt.Parent:IsA("Model") and prompt.Parent.PrimaryPart then
            return prompt.Parent.PrimaryPart.Position
        end
    end
end

local function quickPurchase(prompt)
    if not prompt or not prompt:IsA("ProximityPrompt") then return end
    if not prompt.Enabled then return end
    if boughtPrompts[prompt] then return end

    local objectText = prompt.ObjectText or ""
    if not matchesTarget(objectText) then return end

    local pos = getPromptPosition(prompt)
    if pos and (humanoidRootPart.Position - pos).Magnitude > config.purchaseRange then return end

    boughtPrompts[prompt] = true
    task.spawn(function()
        pcall(function()
            local originalHold = prompt.HoldDuration
            prompt.HoldDuration = 0
            prompt.MaxActivationDistance = 30

            prompt:InputHoldBegin()
            task.wait(0.05)
            prompt:InputHoldEnd()

            prompt.HoldDuration = originalHold
            print("[âœ“] Bought: "..objectText)
        end)
        task.wait(0.3)
        boughtPrompts[prompt] = nil
    end)
end

-- Initialize
local screenGui, frame, autoToggle, toggleCircle, searchBox, scrollFrame, statusLabel, selectedDisplay, searchFrame, editBtn, toggleMenuBtn = createGUI()
gui = screenGui
mainFrame = frame
populateItems(scrollFrame, "", selectedDisplay)
updateSelectedDisplay(selectedDisplay)

-- Toggle Menu
toggleMenuBtn.MouseButton1Click:Connect(function()
    menuVisible = not menuVisible
    mainFrame.Visible = menuVisible
    toggleMenuBtn.BackgroundColor3 = menuVisible and Color3.fromRGB(35, 35, 45) or Color3.fromRGB(60, 60, 75)
end)

-- Edit Button
editBtn.MouseButton1Click:Connect(function()
    local isEditing = scrollFrame.Visible
    scrollFrame.Visible = not isEditing
    searchFrame.Visible = not isEditing
    editBtn.Text = isEditing and "Edit" or "Done"
    editBtn.BackgroundColor3 = isEditing and Color3.fromRGB(45, 110, 200) or Color3.fromRGB(50, 180, 100)
end)

-- Auto Toggle (iOS style)
autoToggle.MouseButton1Click:Connect(function()
    config.autoEnabled = not config.autoEnabled
    
    local targetPos = config.autoEnabled and UDim2.new(1, -21, 0.5, -9) or UDim2.new(0, 3, 0.5, -9)
    local targetColor = config.autoEnabled and Color3.fromRGB(50, 200, 80) or Color3.fromRGB(60, 60, 75)
    
    TweenService:Create(toggleCircle, TweenInfo.new(0.2), {Position = targetPos}):Play()
    TweenService:Create(autoToggle, TweenInfo.new(0.2), {BackgroundColor3 = targetColor}):Play()
    
    statusLabel.Text = "Status: "..(config.autoEnabled and "ğŸŸ¢ Active" or "âš« Idle")
end)

searchBox:GetPropertyChangedSignal("Text"):Connect(function()
    populateItems(scrollFrame, searchBox.Text, selectedDisplay)
end)

-- Auto Purchase Loop
task.spawn(function()
    while true do
        if config.autoEnabled then
            for _, obj in ipairs(Workspace:GetDescendants()) do
                if obj:IsA("ProximityPrompt") then
                    quickPurchase(obj)
                end
            end
        end
        task.wait(config.scanInterval)
    end
end)

-- Character Respawn Handler
player.CharacterAdded:Connect(function(newChar)
    character = newChar
    humanoidRootPart = character:WaitForChild("HumanoidRootPart")
end)

print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("âœ“ Pulsar X Auto Buy Loaded (Landscape)")
print("âœ“ Click â˜° to toggle menu")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")